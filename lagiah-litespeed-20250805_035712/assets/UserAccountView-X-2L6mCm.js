import{d as U,l as A,r as y,P as b,y as E,p as S,m as C,e as i,a as e,t as f,q as l,n as M,h as w,b as d,v as u,u as V,o as c}from"./index-CCw3ahY3.js";import{a as x}from"./auth-jl1oWiwK.js";const F={class:"max-w-4xl mx-auto"},N={class:"bg-white rounded-lg shadow-sm border border-gray-200 mb-6"},D={class:"p-6"},z={class:"flex items-center space-x-6 mb-6"},j={class:"relative"},B=["src"],I={class:"flex-1"},R={class:"text-xl font-semibold text-gray-900"},L={class:"text-gray-600"},H={class:"flex items-center mt-2"},T={class:"ml-2 text-xs text-gray-500"},q={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},W={class:"flex justify-end"},Y=["disabled"],$={key:0},G={key:1},J={class:"bg-white rounded-lg shadow-sm border border-gray-200 mb-6"},K={class:"p-6"},O={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Q={class:"flex justify-end"},X=["disabled"],Z={key:0},ee={key:1},te=U({__name:"UserAccountView",setup(se){const r=A();V();const m=y(!1),p=y(!1),n=b({name:"",email:""}),o=b({currentPassword:"",newPassword:"",confirmPassword:""}),v=E(()=>r.user?.name?`https://ui-avatars.com/api/?name=${encodeURIComponent(r.user.name)}&background=3b82f6&color=ffffff&size=80`:"https://ui-avatars.com/api/?name=User&background=3b82f6&color=ffffff&size=80"),h=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown",P=()=>{},_=async()=>{m.value=!0;try{const t=await x.updateProfile({name:n.name,email:n.email});t.status==="success"?(t.data&&t.data.user&&(r.user=t.data.user),alert("Profile updated successfully!")):alert("Failed to update profile. Please try again.")}catch{alert("Error updating profile. Please try again.")}finally{m.value=!1}},k=async()=>{if(o.newPassword!==o.confirmPassword){alert("New passwords do not match");return}if(o.newPassword.length<6){alert("New password must be at least 6 characters long");return}p.value=!0;try{(await x.changePassword({currentPassword:o.currentPassword,newPassword:o.newPassword})).status==="success"?(o.currentPassword="",o.newPassword="",o.confirmPassword="",alert("Password changed successfully! You can now use your new password to login.")):alert("Failed to change password. Please try again.")}catch{alert("Error changing password. Please try again.")}finally{p.value=!1}},g=()=>{r.user&&(n.name=r.user.name||"",n.email=r.user.email||"")};return S(()=>r.user,t=>{t&&g()},{immediate:!0}),C(async()=>{await r.initialize(),g()}),(t,s)=>(c(),i("div",F,[s[13]||(s[13]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"User Account"),e("p",{class:"mt-2 text-gray-600"},"Manage your account settings and profile information")],-1)),e("div",N,[s[8]||(s[8]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h2",{class:"text-lg font-semibold text-gray-900"},"Profile Information"),e("p",{class:"text-sm text-gray-600 mt-1"},"Update your personal information and contact details")],-1)),e("div",D,[e("div",z,[e("div",j,[e("img",{src:v.value,alt:"Profile",class:"h-20 w-20 rounded-full border-4 border-gray-200"},null,8,B),e("button",{onClick:P,class:"absolute -bottom-1 -right-1 bg-primary-600 text-white rounded-full p-1 hover:bg-primary-700 transition-colors"},s[5]||(s[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1)]))]),e("div",I,[e("h3",R,f(l(r).user?.name||"User Name"),1),e("p",L,f(l(r).user?.email||"user@example.com"),1),e("div",H,[e("span",{class:M(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-green-100 text-green-800":l(r).user?.role==="ADMIN","bg-blue-100 text-blue-800":l(r).user?.role==="STAFF","bg-gray-100 text-gray-800":l(r).user?.role==="VIEWER"}])},f(l(r).user?.role||"USER"),3),e("span",T,"Member since "+f(h(l(r).user?.createdAt)),1)])])]),e("form",{onSubmit:w(_,["prevent"]),class:"space-y-4"},[e("div",q,[e("div",null,[s[6]||(s[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Full Name",-1)),d(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>n.name=a),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter your full name"},null,512),[[u,n.name]])]),e("div",null,[s[7]||(s[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email Address",-1)),d(e("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>n.email=a),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter your email"},null,512),[[u,n.email]])])]),e("div",W,[e("button",{type:"submit",disabled:m.value,class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"},[m.value?(c(),i("span",$,"Updating...")):(c(),i("span",G,"Update Profile"))],8,Y)])],32)])]),e("div",J,[s[12]||(s[12]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h2",{class:"text-lg font-semibold text-gray-900"},"Security Settings"),e("p",{class:"text-sm text-gray-600 mt-1"},"Manage your password and security preferences")],-1)),e("div",K,[e("form",{onSubmit:w(k,["prevent"]),class:"space-y-4"},[e("div",O,[e("div",null,[s[9]||(s[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Current Password",-1)),d(e("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>o.currentPassword=a),type:"password",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter current password"},null,512),[[u,o.currentPassword]])]),e("div",null,[s[10]||(s[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"New Password",-1)),d(e("input",{"onUpdate:modelValue":s[3]||(s[3]=a=>o.newPassword=a),type:"password",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter new password"},null,512),[[u,o.newPassword]])]),e("div",null,[s[11]||(s[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Confirm New Password",-1)),d(e("input",{"onUpdate:modelValue":s[4]||(s[4]=a=>o.confirmPassword=a),type:"password",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Confirm new password"},null,512),[[u,o.confirmPassword]])])]),e("div",Q,[e("button",{type:"submit",disabled:p.value,class:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"},[p.value?(c(),i("span",Z,"Changing...")):(c(),i("span",ee,"Change Password"))],8,X)])],32)])])]))}});export{te as default};
